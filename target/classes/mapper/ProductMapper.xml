<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kgc.easybuy.dao.ProductMapper">
    <select id="getProductList" resultType="Product">
        select  p.id,
        p.name,
        description,
        price,
        stock,
        categoryLevelId,
        fileId,
        p.isDelete,
        p.createTime,
        filePath,
        c.name cname,
        parentId,
        type
        from easybuy_product p,easybuy_file f,easybuy_product_category c
        <where>
            p.id = f.productId and p.categoryLevelId = c.id
            and p.isDelete = 0
        </where>
    </select>

    <select id="getProductByFirstCategoryId" parameterType="int" resultType="Product">
        SELECT p.id,
               p.name,
               description,
               price,
               stock,
               categoryLevelId,
               fileId,
               filePath,
               p.isDelete,
               p.createTime,
               c.name,
               parentId,
               type
        FROM easybuy_product p,easybuy_file f,easybuy_product_category c
        WHERE p.id = f.productId and p.categoryLevelId = c.id
          and p.isDelete = 0
          AND parentId IN (SELECT id FROM easybuy_product_category WHERE parentId = #{id})
    </select>

    <select id="getHotProduct" resultType="Product">
        SELECT  p.id,`name`,
                description,
                price,
                stock,
                categoryLevelId,
                fileId,
                p.createTime,
                filePath
        FROM easybuy_product p,easybuy_file f
        WHERE p.id = f.productId and p.isDelete = 0 and f.isDelete = 0  and p.id iN(SELECT productId
             FROM easybuy_order_detail
              GROUP BY productId)
            LIMIT 0,4
    </select>

    <select id="getProductById" parameterType="int" resultType="Product">
        select  p.id,
        p.name,
        description,
        price,
        stock,
        categoryLevelId,
        fileId,
        p.isDelete,
        p.createTime,
        filePath,
        c.name cname,
        parentId,
        type
        from easybuy_product p,easybuy_file f,easybuy_product_category c
        <where>
            p.id = f.productId and p.categoryLevelId = c.id
            and p.id = #{id}
            and p.isDelete = 0
        </where>
    </select>

    <select id="getRecommendProduct" parameterType="Product" resultType="Product">
        SELECT  p.id,
                p.name,
                description,
                price,
                stock,
                categoryLevelId,
                fileId,
                p.isDelete,
                p.createTime,
                filePath,
                c.name cname,
                parentId,
                type FROM easybuy_product p,easybuy_product_category c,easybuy_file
        WHERE p.categoryLevelId = c.id and productId = p.id
          AND c.parentId = #{parentId} AND p.id != #{id} AND p.isDelete = 0
        limit 0,3
    </select>

    <select id="setProductTes" resultType="Product">
        select  p.id,
        p.name,
        description,
        price,
        stock,
        categoryLevelId,
        fileId,
        p.isDelete,
        p.createTime,
        filePath,
        c.name cname,
        brandId,
        b.name brandName,
        parentId,
        type
        from easybuy_product p,easybuy_file f,easybuy_product_category c,easybuy_brand b
        <where>
            p.id = f.productId and p.categoryLevelId = c.id
            and b.id = brandId and f.isDelete = 0 and c.isDel = 0 and p.isDelete = 0
        </where>
    </select>

    <select id="getProductBySecondCategoryId" parameterType="int" resultType="Product">
        SELECT p.id,
               p.name,
               description,
               price,
               stock,
               categoryLevelId,
               fileId,
               filePath,
               p.isDelete,
               p.createTime,
               c.name,
               parentId,
               type
        FROM easybuy_product p,easybuy_file f,easybuy_product_category c
        WHERE p.id = f.productId and p.categoryLevelId = c.id
          and p.isDelete = 0
          AND parentId = #{id}
    </select>

    <select id="getProductByThreeCategoryId" parameterType="int" resultType="Product">
        SELECT p.id,
               p.name,
               description,
               price,
               stock,
               categoryLevelId,
               fileId,
               filePath,
               p.isDelete,
               p.createTime,
               c.name,
               parentId,
               type
        FROM easybuy_product p,easybuy_file f,easybuy_product_category c
        WHERE p.id = f.productId and p.categoryLevelId = c.id
          and p.isDelete = 0
          AND c.id = #{id}
    </select>
</mapper>